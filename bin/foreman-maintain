#!/usr/bin/env ruby

$LOAD_PATH.unshift(File.expand_path('../../lib', __FILE__))

require 'foreman_maintain'

require 'pp'

ForemanMaintain.setup
puts 'Detected features:'
pp ForemanMaintain.detect_features

puts 'Detected scenarios:'
detected_scenarios = ForemanMaintain.detect_scenarios
pp detected_scenarios

scenario_class = Scenarios::PreUpgradeCheckSatellite_6_2

scenario = detected_scenarios.find { |s| s.is_a? Scenarios::PreUpgradeCheckSatellite_6_2 }

unless scenario
  puts "#{scenario_class} not detected among #{detected_scenarios}"
  exit
end

reporter = ForemanMaintain::Reporter::CLIReporter.new
runner = ForemanMaintain::Runner.new(reporter, scenario)
runner.run
